@using DistributorWebsite.MVC.WebUI.Models
@model DistributorWebsite.MVC.WebUI.Models.WebOrderEntryDTO
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    bool showShoppingCart = (ViewBag.ShowShoppingCart == null ? false : (bool)ViewBag.ShowShoppingCart);
    string shoppingCartClient = (ViewBag.ShoppingCartClient == null ? "" : (String)ViewBag.ShoppingCartClient);
}

<h1 class="HC-page-header">@ViewBag.Title</h1>

<div ng-app="HCE" style="clear: both;">

    <!-- SHOPPING CART -->
    <div id="divSHOPPINGCART" style="display: none;">
        <div class="ng-cloak" ng-cloak>
            @using (Html.BeginCustomDynamicForm<ShoppingCartDTO>(DistributorWebsite.MVC.WebUI.Helpers.Application.Instance.APIS.DistributorWebAPI, "ShoppingCart", eDynamicFormSection.DynamicSearchGrid | eDynamicFormSection.DynamicSearchGridHeaders, entityPath: "/Default.ForClient(Client='{client}')", autoInit: false, additionalItems: new Dictionary<string, string>() { { "data-norecords-entity", HCResources.Products } }, fixedPageSize: 999))
        {
            <tr id="trShoppingCartHeader" class="table-header-row hidden-print ng-cloak">
                <th colspan="6">
                    <div class="btn-group pull-right hidden-print">
                        <a href="#" class="btn btn-default" onclick="HCE.WebOrders.ShowSection('PRODUCTS')"><span class="fa fa-close fa-lg"></span></a>
                    </div>
                    <h1 style="margin: 0">@HCResources.ShoppingCart <span class="fa fa-shopping-cart fa-lg"></span></h1>
                </th>
            </tr>

            <tbody>
                <tr class="ng-cloak" ng-repeat="entity in entities | filter:{ProductCode:'!TOTAL'}" data-keys='{"ProductCode":{{ entity.ProductCode | json}},"Client":{{ entity.Client | json}}}'>
                    <td>{{ entity.ProductCode }}<span class="hidden-sm hidden-md hidden-lg"><br /><span class="smallgraytext">{{ entity.ProductDescription }}</span></span></td>
                    <td class="hidden-xs">{{ entity.ProductDescription }}</td>
                    <td><input class="form-control input-sm ng-class:{'edited': entity.UpdatedQuantity}" type="number" value="0" data-type="WEBPRODUCT" data-product-code="{{ entity.ProductCode }}" data-client="{{ entity.Client }}" ng-model="entity.Quantity" min="0" max="5000" /><span class="hidden-sm hidden-md hidden-lg"><span ng-bind-html="entity.TotalPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></span></span></td>
                    <td class="text-right hidden-xs" ng-bind-html="entity.UnitPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                    <td class="text-right" ng-bind-html="entity.TotalPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                </tr>
                <tr class="table-subtotal-row" ng-repeat="entity in entities | filter:{ProductCode:'TOTAL'}">
                    <td class="hidden-xs" colspan="4"><strong>@HCResources.Total:</strong></td>
                    <td class="hidden-sm hidden-md hidden-lg" colspan="2"><strong>@HCResources.Total:</strong></td>
                    <td class="text-right" ng-bind-html="entity.TotalPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                </tr>
                <tr class="table-subtotal-row">
                    <td colspan="6" class="text-center">
                        <button type="button" id="btnEMPTYCART" class="btn btn-danger" ng-disabled="entities === null || entities.length <= 0"><span class="hidden-xs">@HCResources.EmptyCart</span><span class="hidden-sm hidden-md hidden-lg">@HCResources.Empty</span> <span class="fa fa-times fa-lg"></span></button>
                        <button type="button" id="btnUPDATEQUANTITIES" class="btn btn-success" ng-disabled="!UpdatedQuantities || entities === null || entities.length <= 0"><span class="hidden-xs">@HCResources.UpdateQuantities</span><span class="hidden-sm hidden-md hidden-lg">@HCResources.Update</span> <span class="fa fa-pencil-square fa-lg"></span></button>
                        <button type="button" id="btnCHECKOUT" class="btn btn-success" ng-disabled="entities === null || entities.length <= 0" data-client="{{ entities[0].Client }}">@HCResources.Checkout <span class="fa fa-shopping-cart fa-lg"></span></button>
                    </td>
                </tr>
            </tbody>
        }
        </div>
    </div>

    <!-- CHEKCOUT FORM -->
    <div id="divCHECKOUT" style="display: none;">

        @using (Html.BeginCustomDynamicForm<AddressControlDTO>(DistributorWebsite.MVC.WebUI.Helpers.Application.Instance.APIS.DistributorWebAPI, "WebOrder", eDynamicFormSection.DynamicOptionButtons, detailUrl: "Distributors/Default.GetOrderEntrySettings(Client='[CLIENT]')", autoInit: false))
        {
        <div class="dynamic-search-table ng-cloak" data-defaultsort="Client" style="padding-top: 5px;">
            <form id="webOrderEntryForm" method="post">
                @Html.AntiForgeryToken()

                <div class="panel HC-panel-det">
                    <div class="panel-heading">
                        <div class="btn-group pull-right hidden-print">
                            <a href="#" class="btn btn-default" data-type="BTNCLOSECHECKOUTWINDOW" onclick="HCE.WebOrders.ShowSection('SHOPPINGCART')"><span class="fa fa-close fa-lg"></span></a>
                        </div>
                        <h1 style="margin-top: 0; margin-bottom: 0;"><span class="fa fa-shopping-cart fa-lg"></span> @HCResources.Checkout</h1>
                        <div class="row hc-wizard" style="padding-top: 10px;" data-type="HCWIZARD" id="CHECKOUTWIZARD">
                            <div class="col-xs-3"><div data-type="HCWIZARDTAB" data-wizard-tab="SHIPPING" data-wizard-tab-index="0" data-wizard-button-text="@HCResources.Continue" class="validated"><span class="fa fa-truck"></span> @HCResources.Step 1<br /><span class="description"><span class="hidden-xs">@HCResources.ShippingInformation</span><span class="hidden-sm hidden-md hidden-lg">@HCResources.Shipping</span></span></div></div>
                            <div class="col-xs-3"><div data-type="HCWIZARDTAB" data-wizard-tab="OPTIONS" data-wizard-tab-index="1" data-wizard-button-text="@HCResources.Continue" class="active"><span class="fa fa-dollar"></span> @HCResources.Step 2<br /><span class="description"><span class="hidden-xs">@HCResources.OrderOptions</span><span class="hidden-sm hidden-md hidden-lg">@HCResources.Options</span></span></div></div>
                            <div class="col-xs-3"><div data-type="HCWIZARDTAB" data-wizard-tab="REVIEW" data-wizard-tab-index="2" data-wizard-button-text="@HCResources.SubmitOrder" data-wizard-button-function="HCE.WebOrders.SubmitOrder"><span class="fa fa-list-alt"></span> @HCResources.Step 3<br /><span class="description"><span class="hidden-xs">@HCResources.OrderSummary</span><span class="hidden-sm hidden-md hidden-lg">@HCResources.Summary</span></span></div></div>
                            <div class="col-xs-3"><div data-type="HCWIZARDTAB" data-wizard-tab="SUBMIT" data-wizard-tab-index="3"><span class="fa fa-play-circle"></span> @HCResources.Step 4<br /><span class="description"><span class="hidden-xs">@HCResources.SubmitOrder</span><span class="hidden-sm hidden-md hidden-lg">@HCResources.Submit</span></span></div></div>
                        </div>
                    </div>
                    <div class="panel-body" style="padding-top: 0;">
                        <div class="row">
                            <div class="col-xs-12">
                                <input type="hidden" name="Country" id="Country" value="{{ OrderEntry.WebOrder.Country }}" />
                                <input type="hidden" name="Client" id="Client" value="{{ OrderEntry.WebOrder.Client }}" />

                                <div data-type="HCWIZARDPANEL" data-wizard-tab="SHIPPING" data-wizard-default-field="FirstName">
                                    <h2 style="padding-top: 0;">@HCResources.Step 1: @HCResources.ShippingInformation</h2>

                                    <div class="form-group">
                                        @Html.LabelFor(o => o.Client)
                                        <input type="text" id="ClientName" name="ClientName" class="form-control medium" ng-model="OrderEntry.WebOrder.ClientName" disabled="disabled" />
                                    </div>

                                    <div class="form-group">
                                        @Html.LabelFor(o => o.Country)
                                        <input type="text" id="CountryName" name="CountryName" class="form-control medium" ng-model="OrderEntry.WebOrder.CountryName" disabled="disabled" />
                                    </div>

                                    <div class="form-group">
                                        <div class="col-xs-12 col-internal" style="padding-bottom: 0;"><label for="FirstName" style="margin-bottom: 0;">@HCResources.ShipToName</label></div>
                                        <div class="col-sm-4 col-internal" style="padding-right: 5px;">
                                            @Html.LabelFor(o => o.FirstName, new { @class = "sub-label" })
                                            @Html.TextBoxFor(o => o.FirstName, new { @class = "form-control nomax", maxlength = AddressControlDTOConstants.MaxFirstNameLength, ng_model = "OrderEntry.WebOrder.FirstName" })
                                            @Html.ValidationMessageFor(o => o.FirstName)
                                        </div>
                                        <div class="col-sm-2 col-internal" style="padding-right: 5px;">
                                            @Html.LabelFor(o => o.MiddleInitial, new { @class = "sub-label" })
                                            @Html.TextBoxFor(o => o.MiddleInitial, new { @class = "form-control nomax", maxlength = 1, ng_model = "OrderEntry.WebOrder.MiddleName" })
                                            @Html.ValidationMessageFor(o => o.MiddleInitial)
                                        </div>
                                        <div class="col-sm-4 col-internal" style="padding-right: 5px;">
                                            @Html.LabelFor(o => o.LastName, new { @class = "sub-label" })
                                            @Html.TextBoxFor(o => o.LastName, new { @class = "form-control nomax", maxlength = 15, ng_model = "OrderEntry.WebOrder.LastName" })
                                            @Html.ValidationMessageFor(o => o.LastName)
                                        </div>
                                        <div class="col-sm-2 col-internal" style="padding-right: 5px;">
                                            @Html.LabelFor(o => o.Suffix, new { @class = "sub-label" })
                                            @Html.TextBoxFor(o => o.Suffix, new { @class = "form-control nomax", maxlength = 4, ng_model = "OrderEntry.WebOrder.Suffix" })
                                            @Html.ValidationMessageFor(o => o.Suffix)
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-xs-12 col-internal" style="padding-top: 10px;">
                                            @Html.LabelFor(o => o.AddressType)
                                            <select name="AddressType" id="AddressType" class="form-control nomax" ng-model="OrderEntry.WebOrder.AddressType">
                                                <option value="MAIN" ng-hide="!OrderEntry.HasMainAddress">@HCResources.MainAddress</option>
                                                <option value="MAIL" ng-hide="!OrderEntry.HasMailAddress">@HCResources.MailAddress</option>
                                                <option value="HOME" ng-hide="!OrderEntry.HasHomeAddress">@HCResources.HomeAddress</option>
                                                <option value="OTHER" ng-hide="!OrderEntry.EnableCustomAddress">@HCResources.OtherAddress</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-12 col-internal" ng-hide="OrderEntry.WebOrder.FormattedAddress === null || OrderEntry.WebOrder.AddressType === 'OTHER'">
                                            <div class="well well-sm">
                                                <h3 style="margin-top: 0;">
                                                    <span ng-hide="OrderEntry.WebOrder.AddressType != 'MAIN'">@HCResources.MainAddress:</span>
                                                    <span ng-hide="OrderEntry.WebOrder.AddressType != 'MAIL'">@HCResources.MailAddress:</span>
                                                    <span ng-hide="OrderEntry.WebOrder.AddressType != 'HOME'">@HCResources.HomeAddress:</span>
                                                </h3>
                                                <span ng-bind-html="OrderEntry.WebOrder.FormattedAddress | to_trusted"></span>
                                            </div>
                                        </div>
                                    </div>

                                    @Html.Partial("~/Views/Shared/_AddressControl.cshtml",
                                                  null,
                                                  new ViewDataDictionary
                                                  {
                                                      { "SCOPEVARSETTINGS", "OrderEntry.CountryAddressSettings" },
                                                      { "SCOPEVARADDRESS", "OrderEntry.WebOrder.ShipToAddress" }
                                                  })

                                    <div class="form-group" style="clear: both;">
                                        @Html.LabelFor(o => o.ContactPhone)
                                        @Html.TextBoxFor(o => o.ContactPhone, new { id = "ContactPhone", data_type="CLIENTPHONEFIELD", @class = "form-control", ng_model = "OrderEntry.WebOrder.ContactPhone", placeholder = "{{ OrderEntry.CountryAddressSettings.PhonePattern}}" })
                                        @Html.ValidationMessageFor(o => o.ContactPhone)
                                    </div>

                                    <div class="form-group">
                                        @Html.LabelFor(o => o.DeliveryMethod)
                                        @Html.DropDownListFor(o => o.DeliveryMethod, new List<SelectListItem>(), new { id = "DeliveryMethod", @class = "form-control" })
                                        @Html.ValidationMessageFor(o => o.DeliveryMethod)
                                    </div>

                                    <div class="form-group" ng-hide="!OrderEntry.WebOrder.DeliveryMethodIsUPS">
                                        @Html.LabelFor(o => o.RequireSignature)
                                        <div class="checkbox" style="margin-top: 0; margin-bottom: 0;">
                                            <label>
                                                <input type="checkbox" ng-checked="OrderEntry.WebOrder.RequireSignature == true" ng-model="OrderEntry.WebOrder.RequireSignature" /> {{OrderEntry.WebOrder.RequireSignature | hcboolean}}
                                            </label>
                                        </div>
                                        <p class="help-block">@HCResources.AdditionalChargeForService</p>
                                    </div>

                                    <div class="form-group" ng-hide="!OrderEntry.EnableShippingInsurance">
                                        @Html.LabelFor(o => o.Insured)
                                        <div class="checkbox" style="margin-top: 0; margin-bottom: 0;">
                                            <label>
                                                <input type="checkbox" ng-checked="OrderEntry.WebOrder.Insured == true" ng-model="OrderEntry.WebOrder.Insured" /> {{OrderEntry.WebOrder.Insured | hcboolean}}
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div data-type="HCWIZARDPANEL" data-wizard-tab="OPTIONS" data-wizard-default-field="optPaymentMethodTRANSMITTAL">

                                    <h2 style="padding-top: 0;">@HCResources.Step 2: @HCResources.OrderOptions</h2>

                                    <div class="form-group">
                                        <label>@HCResources.OrderOptions:</label>

                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optOrderOptions" ng-model="OrderEntry.WebOrder.OrderOptions" ng-checked="OrderEntry.WebOrder.OrderOptions == 'NONE'" id="optOrderOptionsNONE" value="NONE" />
                                                @HCResources.None
                                            </label>
                                        </div>
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optOrderOptions" ng-model="OrderEntry.WebOrder.OrderOptions" ng-checked="OrderEntry.WebOrder.OrderOptions == 'SAMPLE'" id="optOrderOptionsSAMPLE" value="SAMPLE" />
                                                @HCResources.ChargeSampleBalance<br/><span class="smallgraytext">@HCResources.SubjectToApproval</span>
                                            </label>
                                        </div>
                                        <div class="radio" ng-hide="OrderEntry.PromoFundBalance <= 0 || OrderEntry.PromoItemQuantity <= 0">
                                            <label>
                                                <input type="radio" name="optOrderOptions" ng-model="OrderEntry.WebOrder.OrderOptions" ng-checked="OrderEntry.WebOrder.OrderOptions == 'PROMO'" id="optOrderOptionsPROMO" value="PROMO" />
                                                @HCResources.ChargeMyPromoFund<p class="help-block">@HCResources.ChargeMyPromoFundNote &nbsp;<span ng-bind-html="OrderEntry.PromoFundBalanceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></span></p>
                                            </label>
                                       </div>

                                    </div>

                                    <div class="form-group" ng-hide="!OrderEntry.EnablePaymentMethod">
                                        @Html.LabelFor(o => o.PaymentMethod)

                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optPaymentMethod" ng-model="OrderEntry.WebOrder.PaymentMethod" ng-checked="OrderEntry.WebOrder.PaymentMethod == 'TRANSMITTAL'" id="optPaymentMethodTRANSMITTAL" value="TRANSMITTAL">
                                                @HCResources.Transmittal
                                            </label>
                                        </div>
                                        <div class="radio" ng-hide="OrderEntry.PaymentAccounts === null || OrderEntry.PaymentAccounts.length <= 0">
                                            <label>
                                                <input type="radio" name="optPaymentMethod" ng-model="OrderEntry.WebOrder.PaymentMethod" ng-checked="OrderEntry.WebOrder.PaymentMethod == 'PAYMENTACCOUNT'" id="optPaymentMethodPAYMENTACCOUNT" value="PAYMENTACCOUNT" />
                                                @HCResources.UsePaymentAccount:<br/><br/>
                                                <select class="form-control" ng-model="OrderEntry.WebOrder.PaymentAccountID" id="PaymentAccountID" name="PaymentAccountID" ng-disabled="OrderEntry.WebOrder.PaymentMethod !== 'PAYMENTACCOUNT'">
                                                </select>                                                
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        @Html.LabelFor(o => o.OrderNotes)
                                        @Html.TextBoxFor(o => o.OrderNotes, new { id = "OrderNotes", @class = "form-control nomax", ng_model = "OrderEntry.WebOrder.Notes", maxlength = "50" })
                                        @Html.ValidationMessageFor(o => o.OrderNotes)
                                        <p class="help-block">@HCResources.WebOrderNoteMessage</p>
                                    </div>

                                    <div class="form-group">
                                        @Html.LabelFor(o => o.Email)
                                        @Html.TextBoxFor(o => o.Email, new { id = "Email", @class = "form-control nomax", ng_model = "OrderEntry.WebOrder.Email" })
                                        @Html.ValidationMessageFor(o => o.Email)
                                        <p class="help-block">@HCResources.EmailAddressForOrderConfirmation</p>
                                    </div>

                                </div>

                                <div data-type="HCWIZARDPANEL" data-wizard-tab="REVIEW" data-wizard-default-field="">
                                    <h2 stype="padding-top: 0;">@HCResources.Step 3: @HCResources.OrderSummary</h2>
                                    @Html.Partial("~/Views/DistributorService/_WebOrderSummary.cshtml")
                                </div>
                                <div data-type="HCWIZARDPANEL" data-wizard-tab="SUBMIT" data-wizard-default-field="">

                                    <br />

                                    <div class="alert alert-success">
                                        <strong><span class="fa fa-check-circle fa-lg"></span> &nbsp;@HCResources.OrderSubmittedSuccessfully</strong>
                                    </div>

                                    <div class="row">
                                        <div class="col-xs-12 padbottom">
                                            <label>@HCResources.WebOrderID:</label>
                                            <div><h1 class="text-success" style="padding: 0; margin: 0;">{{ OrderEntry.WebOrder.OrderID }}</h1></div>
                                            <p class="help-block">@HCResources.WebOrderIDNote</p>
                                        </div>
                                    </div>

                                    @Html.Partial("~/Views/DistributorService/_WebOrderSummary.cshtml")
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer text-center hidden-print" id="WEBORDERBUTTONBAR">
                        <div class="pull-right"><a href="#" class="btn btn-default" data-type="BTNCLOSECHECKOUTWINDOW" onclick="HCE.WebOrders.ShowSection('SHOPPINGCART')">@HCResources.Cancel <span class="fa fa-close fa-lg"></span></a></div>
                        <div class="text-left"><button class="btn btn-primary" data-type="HCWIZARDCONTINUE" data-wizard-id="CHECKOUTWIZARD">@HCResources.Continue <span class="fa fa-chevron-circle-right"></span></button></div>
                    </div>
                </div>
            </form>
        </div>
        }

    </div>

    <div id="divPRODUCTSEARCH">

        <!-- Nav tabs -->
        <ul id="ccpaymentstablist" class="nav nav-tabs bordered" role="tablist">
            <li role="presentation" class="active"><a id="btnWEBORDERHISTORY" href="#wohistory" aria-controls="wohistory" role="tab" data-toggle="tab" data-type="WEBORDERTAB">@HCResources.WebOrderHistory</a></li>
            <li role="presentation" ng-hide="showdetails"><a id="btnNEWWEBORDER" href="#wonew" aria-controls="wonew" role="tab" data-toggle="tab" data-type="WEBORDERTAB">@HCResources.NewWebOrder</a></li>
        </ul>

        <div class="tab-content">

            <!-- WEB ORDER HISTORY -->
            <div role="tabpanel" class="tab-pane bordered active ng-cloak" id="wohistory" style="padding-top: 10px;">
                @using (Html.BeginCustomDynamicForm<WebOrderDTO>(DistributorWebsite.MVC.WebUI.Helpers.Application.Instance.APIS.DistributorWebAPI, "WebOrders", Constants.DYNAMICTABLEWITHHEADERS, autoInit: true, detailUrl: "WebOrders({OrderID})?$expand=WebOrderItems", additionalItems: new Dictionary<string, string>() { { "data-norecords-entity", HCResources.Orders } }))
                {
                    <tbody>
                        <tr class="ng-cloak ng-class:{'highlight': entity.Highlight }" ng-repeat="entity in entities" data-keys='{"OrderID":{{ entity.OrderID | json}}}'>
                            <td class="hidden-md hidden-lg">
                                <div class="container-fluid docucite-item" ng-cloak>
                                    <div class="row">
                                        <div class="col-xs-7">
                                            <strong>@(HCResources.OrderNo): {{ entity.OrderID }}</strong>
                                        </div>
                                        <div class="col-xs-5 text-right">
                                            <span class="label ng-class:{'label-primary': entity.Status === 'WORKFLOW', 'label-default': entity.Status !== 'WORKFLOW'}">{{ entity.Status }}</span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-8">{{ entity.ShipName }}</div>
                                        <div class="col-xs-4 text-right">{{ entity.OrderDate | hcdate }}</div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-6 smallgraytext">{{ entity.City }}, {{ entity.State }}</div>
                                        <div class="col-xs-6 text-right"><span ng-hide="entity.Client != 'HC'">US</span><span ng-hide="entity.Client == 'HC'">{{ entity.Client }}</span> - {{ entity.DistributorNo }}</div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 text-right" ng-bind-html="entity.TotalMerchandiseJSON | hccurrency:'both':DisplayCurrency:2:true:false"></div>
                                    </div>
                                </div>
                            </td>
                            <td class="hidden-xs hidden-sm">{{ entity.OrderID }}</td>
                            <td class="hidden-xs hidden-sm">{{ entity.Client }}</td>
                            <td class="hidden-xs hidden-sm">{{ entity.OrderDate | hcdate }}</td>
                            <td class="hidden-xs hidden-sm text-right" ng-bind-html="entity.TotalMerchandiseJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                            <td class="hidden-xs hidden-sm">{{ entity.ShipName }}<span class="hidden-lg smallgraytext"><br/>{{ entity.City }}, {{ entity.State }} {{ entity.ZipCode }}</span></td>
                            <td class="hidden-xs hidden-sm hidden-md">{{ entity.City}}</td>
                            <td class="hidden-xs hidden-sm hidden-md">{{ entity.State}}</td>
                            <td class="hidden-xs hidden-sm hidden-md">{{ entity.ZipCode }}</td>
                            <td class="hidden-xs hidden-sm">{{ entity.Status }}</td>
                        </tr>
                    </tbody>
                }
            </div>

            <!-- NEW WEB ORDER -->
            <div role="tabpanel" class="tab-pane bordered ng-cloak" id="wonew" style="padding-top: 10px;" ng-hide="showdetails">

                @using (Html.BeginCustomDynamicForm<WebProductDTO>(DistributorWebsite.MVC.WebUI.Helpers.Application.Instance.APIS.DistributorWebAPI, "Distributors", Constants.DYNAMICTABLEWITHHEADERS, entityPath: "/Default.WebProducts(Client='{client}')", autoInit: false, additionalItems: new Dictionary<string, string>() { { "data-norecords-entity", HCResources.Products } }))
                {
                    <tr id="trProductSearchHeader" class="table-header-row hidden-print ng-cloak">
                        <th colspan="5">
                            <div class="row ng-cloak">
                                <div class="col-xs-6 col-sm-6 col-md-4 padbottom">
                                    <label class="small-header-label" for="PRODUCTSEARCHCLIENT">@HCResources.Client:</label>
                                    @Html.DropDownList("PRODUCTSEARCHCLIENT", DistributorWebsite.MVC.WebUI.Helpers.Common.GetSecurityItemClients(eSecurityItem.mnuWebOrders, false), new { id = "PRODUCTSEARCHCLIENT", @class = "form-control nomax" })
                                </div>
                                <div class="col-xs-6 col-sm-6 col-md-4 padbottom ng-cloak" ng-hide="WebOrderClientInfo.ProductGroups === null || WebOrderClientInfo.ProductGroups === undefined">
                                    <label class="small-header-label" for="PRODUCTSEARCHGROUP">@HCResources.Category:</label>
                                    <select id="PRODUCTSEARCHGROUP" name="PRODUCTSEARCHGROUP" class="form-control" data-type="hcfilter" data-filter-type="string" data-field="ProductGroup" data-islist="true">
                                        <option value=""></option>
                                        <option ng-repeat="group in WebOrderClientInfo.ProductGroups" value="{{group.ProductGroup}}">{{ group.ProductGroupDescription }}</option>
                                    </select>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-4 text-right" ng-hide="WebOrderClientInfo.ProductGroups === null || WebOrderClientInfo.ProductGroups === undefined">
                                    <div><span class="fa fa-shopping-cart fa-lg"></span> {{ ItemsInCart }} @HCResources.ItemsInCart</div>
                                    <div ng-hide="ItemsInCart == 0">
                                        <button type="button" id="btnVIEWCART" class="btn btn-success btn-sm">@HCResources.ViewCart</button>
                                    </div>
                                </div>
                                <div class="col-xs-12">
                                    <label class="small-header-label">@HCResources.AvailablePromoFundBalance: &nbsp;</label><span ng-bind-html="ClientPromoFundBalanceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></span>
                                </div>
                            </div>
                        </th>
                    </tr>

                    <tbody>
                        <tr class="ng-cloak" ng-repeat="entity in entities" data-keys='{"ProductCode":{{ entity.ProductCode | json}},"Client":{{ entity.Client | json}}}'>
                            <td>{{ entity.ProductCode }}<span class="hidden-md hidden-lg" ng-hide="entity.IsPromoEligible !== true"> &nbsp;<span class="fa fa-star" ></span></span><span class="hidden-sm hidden-md hidden-lg"><span class="smallgraytext"><br />{{ entity.ProductDescription }}</span></span></td>
                            <td class="hidden-xs">{{ entity.ProductDescription}}</td>
                            <td class="hidden-xs hidden-sm text-center"><span class="fa fa-check-square" ng-hide="entity.IsPromoEligible !== true"></span><span class="fa fa-square-o" ng-hide="entity.IsPromoEligible === true"></span></td>
                            <td class="text-right" ng-bind-html="entity.PriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                            <td>
                                <div class="input-group">
                                    <input class="form-control input-sm" style="min-width: 50px !important;" type="number" value="0" data-type="WEBPRODUCT" data-product-code="{{ entity.ProductCode }}" data-client="{{ entity.Client }}" min="0" max="5000" />
                                    <span class="input-group-btn input-group-sm">
                                        <button class="btn btn-sm btn-success" type="button" data-type="ADDITEMTOCART" data-product-code="{{ entity.ProductCode }}"><span class="fa fa-cart-plus fa-lg"></span></button>
                                    </span>
                                </div>
                            </td>
                        </tr>
                        <tr class="table-subtotal-row">
                            <td colspan="5" class="text-right">
                                <div class="hidden-md hidden-lg text-left"><span class="fa fa-star"></span>: <span class="smallgraytext">@HCResources.PromoItemStarNote</span></div>
                                <button type="button" data-type="ADDITEMTOCART" data-product-code="" class="btn btn-success ng-cloak">@HCResources.AddItemsToCart <span class="badge">{{ SelectedItemCount }}</span> <span class="fa fa-cart-plus fa-lg"></span></button>
                            </td>
                        </tr>
                    </tbody>
                }
            </div>
        </div>

        <!-- WEB ORDER DETAILS -->
        <div class="panel HC-panel-det ng-cloak" data-type="HCDYNAMICDET" data-container="HCDYNAMICGRID_WebOrders" ng-show="showdetails">
            <div class="panel-heading">
                <div class="btn-group pull-right">
                    <a href="#" class="btn btn-default" onclick="HCE.WebOrders.CloseDetailWindow(this)"><span class="fa fa-close fa-lg"></span></a>
                </div>
                <h1>@HCResources.OrderNo: {{ entity.OrderID }}</h1>
            </div>
            <div class="panel-body">

                <div style="padding-top: 5px;">

                    <div class="row">
                        <div class="col-xs-4 padbottom">
                            <label>@HCResources.OrderDate:</label>
                            <div>{{ entity.OrderDate | hcdate }}</div>
                        </div>
                        <div class="col-xs-8 padbottom">
                            <label>@HCResources.Client:</label>
                            <div>{{ entity.Client }}</div>
                        </div>
                    </div>

                    <h3 class="section-header">@HCResources.ShippingInformation</h3>

                    <div class="row">
                        <div class="col-xs-12 padbottom">
                            <label>@HCResources.Address:</label>
                            <div>
                                {{ entity.ShipName }}<br />
                                <span ng-bind-html="entity.ShipAddress | to_trusted"></span><br />
                                {{ entity.CountryCode }}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-4">
                            <label>@HCResources.DeliveryMethod:</label>
                            <div>{{ entity.DeliveryMethod }}</div>
                        </div>
                        <div class="col-sm-4 padbottom">
                            <label>@HCResources.UPSSignatureRequired:</label>
                            <div>{{entity.IsSignatureRequired | hcboolean}}</div>
                        </div>
                        <div class="col-sm-4 padbottom">
                            <label>@HCResources.Insured:</label>
                            <div>{{entity.IsInsured | hcboolean}}</div>
                        </div>
                    </div>

                    <h3 class="section-header">@HCResources.OrderOptions</h3>

                    <div class="row">
                        <div class="col-sm-4 padbottom" ng-hide="!entity.IsSampleBalanceOrder && !entity.UsePromoAccountForGiftItems">
                            <label>@HCResources.OrderOptions:</label>
                            <div>
                                <span ng-show="entity.IsSampleBalanceOrder">@HCResources.ChargeSampleBalance</span>
                                <span ng-show="entity.UsePromoAccountForGiftItems">@HCResources.ChargeMyPromoFund</span>
                            </div>
                        </div>

                        <div class="col-sm-4 padbottom">
                            <label>@HCResources.PaymentMethod:</label>
                            <div>
                                <span ng-show="entity.PaymentAccountID === null || entity.PaymentAccountID <= 0">@HCResources.Transmittal</span>
                                <span ng-show="entity.PaymentAccountID !== null && entity.PaymentAccountID > 0">{{ entity.PaymentNote }}</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-12 padbottom">
                            <label>@HCResources.EmailAddress:</label>
                            <div>{{ entity.EmailAddress }}</div>
                        </div>
                    </div>

                    <div class="row" ng-hide="entity.ShipComment === null || entity.ShipComment === ''">
                        <div class="col-xs-12 padbottom">
                            <label>@HCResources.OrderNotes:</label>
                            <div>{{ entity.ShipComment }}</div>
                        </div>
                    </div>

                    <h3 class="section-header">@HCResources.Products</h3>

                    <div class="row">
                        <div class="col-sm-12 padbottom">
                            <table class="table table-striped table-bordered dynamic-search-table" data-defaultsort="ItemID">

                                <thead>
                                    <tr class="column-header-row">
                                        <th data-field="ProductCode">@HCResources.Article</th>
                                        <th data-field="ProductDescription" class="hidden-xs">@HCResources.Description</th>
                                        <th data-field="Quantity" class="hidden-xs">@HCResources.Quantity</th>
                                        <th data-field="UnitPrice" class="text-right hidden-xs">@HCResources.UnitPrice</th>
                                        <th data-field="TotalPrice" class="text-right">@HCResources.Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="product in entity.WebOrderItems">
                                        <td>{{ product.ProductCode }}<span class="hidden-sm hidden-md hidden-lg"> &nbsp;<i>({{ product.Quantity }} @@ <span ng-bind-html="product.UnitPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></span>)</i><br /><span class="smallgraytext">{{ product.ProductDescription }}</span></span></td>
                                        <td class="hidden-xs">{{ product.ProductDescription }}</td>
                                        <td class="hidden-xs">{{ product.Quantity }}</td>
                                        <td class="text-right hidden-xs" ng-bind-html="product.UnitPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                                        <td class="text-right" ng-bind-html="product.TotalPriceJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                                    </tr>
                                    <tr class="table-subtotal-row">
                                        <td colspan="4" class="hidden-xs"><strong>@HCResources.Total:</strong></td>
                                        <td class="hidden-sm hidden-md hidden-lg"><strong>@HCResources.Total:</strong></td>
                                        <td class="text-right" ng-bind-html="entity.TotalMerchandiseJSON | hccurrency:'both':DisplayCurrency:2:true:false"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <h3 class="section-header" ng-show="entity.Quote !== null">@HCResources.EstimatedCharges</h3>

                    <div class="row" ng-show="entity.Quote !== null">

                        <div class="col-xs-12">
                            <div class="alert alert-danger">
                                <span class="fa fa-exclamation-circle"></span> @Html.Raw(HCResources.WebOrderQuoteNote)
                            </div>
                        </div>

                        <div class="col-sm-12 padbottom" ng-repeat="charge in entity.Quote.Charges">
                            <table class="table table-striped table-bordered dynamic-search-table" data-defaultsort="SequenceNo">
                                <thead>
                                    <tr class="table-header-row">
                                        <th colspan="2" ng-show="charge.Type === 'PROMOFUND'">@HCResources.PromoFundCharges</th>
                                        <th colspan="2" ng-show="charge.Type === 'TRANSMITTAL'">@HCResources.TransmittalCharges</th>
                                    </tr>
                                    <tr class="column-header-row">
                                        <th data-field="Description">@HCResources.Description</th>
                                        <th data-field="Amount" class="text-right">@HCResources.Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="trans in charge.Charges">
                                        <td>{{ trans.Description }}<span class="smallgraytext" ng-hide="trans.Note === null || trans.Note === ''"><br />{{ trans.Note }}</span></td>
                                        <td ng-bind-html="trans.AmountJSON | hccurrency:'both':DisplayCurrency:2:true:false" class="text-right"></td>
                                    </tr>
                                    <tr class="table-subtotal-row">
                                        <td>@HCResources.Total:</td>
                                        <td ng-bind-html="charge.TotalJSON | hccurrency:'both':DisplayCurrency:2:true:false" class="text-right"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>

                    <div class="row" ng-show="entity.Quote === null">
                        <div class="col-xs-12">
                            <div class="alert alert-danger">
                                <span class="fa fa-exclamation-circle"></span> @Html.Raw(HCResources.WebOrderSalesTaxNote)
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="panel-footer text-right"><a href="#" class="btn btn-default" onclick="HCE.WebOrders.CloseDetailWindow(this)">@HCResources.Close <span class="fa fa-close"></span></a></div>
        </div>

    </div>

</div>

@section scripts {

    <script type="text/javascript">
	<!--
    HCE.Resources.NoProductsHeader = "@HCResources.NoProductsHeader";
    HCE.Resources.NoProductsMessage = "@HCResources.NoProductsMessage";
    HCE.Resources.AddedToCart = "@HCResources.AddedToCart";
    HCE.Resources.EmptyCartTitle = "@HCResources.EmptyCartHeader";
    HCE.Resources.EmptyCartMessage = "@HCResources.EmptyCartMessage";
    HCE.Resources.Yes = "@HCResources.Yes";
    HCE.Resources.Cancel = "@HCResources.Cancel";
    HCE.Resources.NewOrderSuccessTitle = "@Html.Raw(HCResources.OrderSubmittedSuccessfully)";
    HCE.Resources.NewOrderSuccessMessage = "@Html.Raw(HCResources.OrderSubmittedSuccessfullyMessage)";
	//-->
    </script>

    @Scripts.Render("~/bundles/Pages/DistributorService/WebOrders")

    <script type="text/javascript">
	 <!--

        $(function () {
        @if  (showShoppingCart)
        {
            @: HCE.WebOrders.ShowShoppingCart('@(shoppingCartClient)');
        }
		});

	 //-->
    </script>
}

